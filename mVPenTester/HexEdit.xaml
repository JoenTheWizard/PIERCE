<Window x:Class="mVPenTester.HexEdit"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:control="clr-namespace:WpfHexaEditor;assembly=WPFHexaEditor"
        xmlns:local="clr-namespace:mVPenTester"
        xmlns:dragablz="http://dragablz.net/winfx/xaml/dragablz"
        mc:Ignorable="d"
        Title="HexEdit" Height="720" Width="1260" WindowStyle="None" AllowsTransparency="True" Loaded="Window_Loaded">
    <Window.Resources>
        <Style x:Key="listStyle" TargetType="ListViewItem">
            <Setter Property="Background" Value="#5a5a5a"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>
        <Style x:Key="buttonStyle" TargetType="Button">
            <Setter Property="Background" Value="Gray"/>
            <Setter Property="Width" Value="90"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontFamily" Value="Consolas"/>
        </Style>
        <Style x:Key="txtBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="#1c1c1c"/>
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>
        <Style TargetType="MenuItem">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontFamily" Value="Consolas"/>
        </Style>
        <Style TargetType="TreeViewItem">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontFamily" Value="Consolas"/>
        </Style>
        <Style x:Key="ButtonMemEditor" TargetType="Button">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Background" Value="#2a2a2a"/>
            <Setter Property="FontFamily" Value="Consolas"/>
        </Style>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="25"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid MouseDown="Grid_MouseDown" Background="#3a3a3a">
            <TextBlock Text="Hex Editor - PIERCE" Margin="5,0" Foreground="White" Padding="0,2"
                       FontWeight="Bold" FontFamily="Consolas"/>
            <Button Width="35" Click="Button_Click" Background="Transparent" Content="✖" Foreground="White" HorizontalAlignment="Right" BorderThickness="0,0,0,0"/>
        </Grid>
        <dragablz:TabablzControl Grid.Row="1" Background="#3a3a3a" BorderThickness="0"
                                 x:Name="bruteforceTABS">
            <TabItem Header="Main Hex Editor" x:Name="mainHex" IsSelected="True">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="10"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="20"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Menu Grid.Row="0" Background="#3a3a3a">
                            <MenuItem Header="_File" Foreground="White" FontFamily="Consolas">
                                <MenuItem Header="_New" Background="#3a3a34"/>
                                <MenuItem Header="Open" Click="MenuItem_Click" Background="#3a3a34"/>
                                <Separator/>
                                <MenuItem Header="Save As" Click="MenuItem_Click_2" Background="#3a3a34"/>
                                <MenuItem Header="Save" Click="MenuItem_Click_1" Background="#3a3a34"/>
                                <Separator/>
                                <MenuItem Header="Close" Background="#3a3a34"/>
                            </MenuItem>
                            <MenuItem Header="_Edit" FontFamily="Consolas">
                                <MenuItem Header="Theme" Foreground="Black" FontFamily="Consolas"/>
                            </MenuItem>
                        </Menu>
                        <Menu Grid.Column="1" Background="#3a3a3a">
                            <MenuItem Header="Assembly Options">
                                <MenuItem Background="#4a4a4a" IsCheckable="True"
                                          IsChecked="True" Header="x64"/>
                                <MenuItem Background="#4a4a4a" IsCheckable="True"
                                          Header="x86"/>
                            </MenuItem>
                            <MenuItem Header="Decoder">
                                <MenuItem Header="Open File" Background="#4a4a4a" Click="MenuItem_Click_6"/>
                                <MenuItem Header="Save Result" Background="#4a4a4a" Click="MenuItem_Click_7"/>
                                <Separator/>
                                <MenuItem Header="base64" FontFamily="Consolas" Click="MenuItem_Click_3" Background="#4a4a4a"/>
                                <MenuItem Header="JWT" FontFamily="Consolas"
                              Click="MenuItem_Click_5" Background="#4a4a4a"/>
                                <Separator/>
                                <MenuItem Header="Hex Dump" x:Name="hxdump"  Click="MenuItem_Click_4"
                              IsCheckable="True" IsChecked="False"
                              FontFamily="Consolas" Background="#4a4a4a"/>
                            </MenuItem>
                            <MenuItem Header="Decompress">
                                <MenuItem Background="#4a4a4a" Header="zlib" IsCheckable="True" x:Name="zlibMenu"
                              Click="MenuItem_Click_9"/>
                            </MenuItem>
                            <MenuItem Header="Encoder">
                                <MenuItem Background="#4a4a4a" Header="base64" Click="MenuItem_Click_10"/>
                            </MenuItem>
                            <MenuItem Header="Options">
                                <MenuItem Header="Skip" IsCheckable="True" Click="MenuItem_Click_8"
                              Background="#4a4a4a"/>
                            </MenuItem>
                        </Menu>
                        <Grid Grid.Column="1" Grid.Row="1" Background="#2e2e2e">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="2.3*"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <TextBox x:Name="disAssemb" FontFamily="Consolas" FontSize="13" AcceptsReturn="True"
                         Margin="0,2,0,2" Foreground="Yellow" Background="Black"/>
                            <Grid Grid.Row="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="2.5*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBox Grid.Row="1" Background="Black" Foreground="White" FontFamily="Consolas"
                        Text="This is the decoder. Paste string here, go to 'Decoder', and select decoding algorithm."
                         TextWrapping="Wrap" x:Name="hexTxBox"/>
                                <Grid Grid.Column="1" Background="#5a5a5a">
                                    <TextBlock x:Name="skippedTextBlock" Text="Skipped"
                                   Margin="5,5,0,0" Foreground="White" FontFamily="Consolas"/>
                                    <TextBox VerticalAlignment="Top" Text="24" FontFamily="Consolas" Padding="0,0"
                                 HorizontalAlignment="Left" x:Name="skippedValue" Width="35" Height="15"
                                 Margin="56,5,0,0"/>
                                    <Separator Margin="2,0,2,150"/>
                                    <TextBlock Text="Hex Dump" FontFamily="Consolas" Margin="5,30,0,0"
                                   Foreground="White"/>
                                    <CheckBox Margin="60,30,0,0" x:Name="hDUMP"
                                  Click="CheckBox_Click"/>
                                    <Separator VerticalAlignment="Top" Margin="2,50,2,0"/>
                                    <TextBlock Text="zlib" FontFamily="Consolas" Margin="5,55,0,0"
                                   Foreground="White"/>
                                    <CheckBox VerticalAlignment="Top" Margin="33,54,0,0" x:Name="zlibCheck" Click="CheckBox_Click_1"/>
                                </Grid>
                                <GridSplitter Grid.Column="0" Background="#2a2a2a" Width="3"/>
                            </Grid>
                        </Grid>
                        <control:HexEditor FontFamily="Consolas" Margin="0,0,3,0" ForegroundOffSetHeaderColor="#FF007ACC" Foreground="White" 
                           ForegroundHighLightOffSetHeaderColor="Yellow"
                           ForegroundSecondColor="Wheat"
                           x:Name="hexEditor" Background="#2a2a2a" Grid.Row="1"/>
                        <GridSplitter Grid.Column="0" Grid.Row="1" Background="#7a7a6a" Width="3"/>
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem Header="Memory Editor">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="20"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Menu Grid.Row="0" Background="#3a3a3a">
                        <MenuItem Header="_File" Foreground="White" FontFamily="Consolas">
                            <MenuItem Header="_Open Running Process" Background="#3a3a3a"/>
                            <Separator/>
                            <MenuItem Header="_New" Background="#3a3a34"/>
                            <MenuItem Header="Open" Click="MenuItem_Click" Background="#3a3a34"/>
                            <MenuItem Header="Save As" Click="MenuItem_Click_2" Background="#3a3a34"/>
                            <MenuItem Header="Save" Click="MenuItem_Click_1" Background="#3a3a34"/>
                            <Separator/>
                            <MenuItem Header="Close" Background="#3a3a34"/>
                        </MenuItem>
                        <MenuItem Header="_Edit" FontFamily="Consolas">
                            <MenuItem Header="Settings" Foreground="Black" FontFamily="Consolas"/>
                        </MenuItem>
                    </Menu>
                    <ListView x:Name="addressFound" Grid.Column="0" Grid.Row="1"
                                      SelectionChanged="addressFound_SelectionChanged" Background="#2a2a2a" Foreground="White" Margin="5 0 0 0">
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalAlignment" Value="Stretch"/>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#3d3d3d"/>
                                        <Setter Property="BorderBrush" Value="#FF2F2F2F"/>
                                    </Trigger>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="#5d5d5d"/>
                                        <Setter Property="BorderBrush" Value="#FF2F2F2F"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.View>
                            <GridView>
                                <GridView.ColumnHeaderContainerStyle>
                                    <Style TargetType="{x:Type GridViewColumnHeader}">
                                        <Setter Property="Background" Value="#FF252526"/>
                                        <Setter Property="Foreground" Value="White"/>
                                        <Setter Property="FontFamily" Value="Consolas"/>
                                        <Setter Property="BorderBrush" Value="Gray"/>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#3d3d3d"/>
                                                <Setter Property="BorderBrush" Value="#FF2F2F2F"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </GridView.ColumnHeaderContainerStyle>
                                <GridViewColumn x:Name="gr1" Header="Address" Width="250" DisplayMemberBinding="{Binding address1}"/>
                                <GridViewColumn x:Name="gr2" Header="Value" Width="120" DisplayMemberBinding="{Binding value1}"/>
                                <GridViewColumn x:Name="gr3" Header="Previous" Width="120" DisplayMemberBinding="{Binding previous1}"/>
                            </GridView>
                        </ListView.View>
                    </ListView>
                    <ProgressBar Grid.Row="1" Grid.Column="1" VerticalAlignment="Top" Background="#2a2a2a"
                                 Height="20" Margin="30 1 30 0"/>
                    <GroupBox Grid.Row="1" VerticalAlignment="Top" Margin="20 30 0 0" Grid.Column="1" Height="85" Header="Scan Options" 
                              Foreground="White" Width="280" HorizontalAlignment="Left">
                        <StackPanel>
                            <TextBlock x:Name="selectedProg" Text="Selected Program:"/>
                            <TextBlock Text="Type:"/>
                            <ComboBox Margin="1 0 130 0">
                                <ComboBoxItem Content="Int16"/>
                                <ComboBoxItem Background="#1a1a1a" IsSelected="True"
                                              Content="Int32"/>
                                <ComboBoxItem Content="Int64"/>
                                <ComboBoxItem Content="Float"/>
                                <ComboBoxItem Content="Double"/>
                            </ComboBox>
                        </StackPanel>
                    </GroupBox>
                    <GroupBox Grid.Row="1" Grid.Column="1" VerticalAlignment="Bottom" Height="170" 
                              Margin="20" Foreground="White" Header="Scan">
                        <Grid>
                    <TextBox Grid.Row="1" x:Name="ScanValue" Grid.Column="1" Height="30" Margin="50 0 50 80" Padding="3"
                             VerticalAlignment="Bottom" Style="{DynamicResource txtBoxStyle}" FontSize="18"/>
                    <Button Grid.Row="1" x:Name="firstScan" Click="firstScan_Click" Grid.Column="1" VerticalAlignment="Bottom" Height="30" Content="First Scan"
                            Style="{DynamicResource ButtonMemEditor}" HorizontalAlignment="Left" Margin="50 0 0 20" Width="120"/> 
                    <Button Grid.Row="1" x:Name="nextScan" Grid.Column="1" Click="nextScan_Click" VerticalAlignment="Bottom" Height="30" Content="Next Scan"
                            Style="{DynamicResource ButtonMemEditor}" HorizontalAlignment="Left" Margin="180 0 0 20" Width="120"/>
                    <Button Grid.Row="1" x:Name="undoScan" Grid.Column="1" VerticalAlignment="Bottom" Height="30" Content="Undo Scan"
                            Style="{DynamicResource ButtonMemEditor}" HorizontalAlignment="Right" Margin="0 0 50 20" Width="120"/>
                        </Grid>
                    </GroupBox>
                    <ListView x:Name="addressListed" Grid.Column="0" Grid.Row="3" Grid.ColumnSpan="2"
                                       SelectionChanged="addressListed_SelectionChanged" Background="#2a2a2a" Foreground="White" Margin="5 10 400 5">
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalAlignment" Value="Stretch"/>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#3d3d3d"/>
                                        <Setter Property="BorderBrush" Value="#FF2F2F2F"/>
                                    </Trigger>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="#5d5d5d"/>
                                        <Setter Property="BorderBrush" Value="#FF2F2F2F"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.View>
                            <GridView>
                                <GridView.ColumnHeaderContainerStyle>
                                    <Style TargetType="{x:Type GridViewColumnHeader}">
                                        <Setter Property="Background" Value="#FF252526"/>
                                        <Setter Property="Foreground" Value="White"/>
                                        <Setter Property="FontFamily" Value="Consolas"/>
                                        <Setter Property="BorderBrush" Value="Gray"/>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#3d3d3d"/>
                                                <Setter Property="BorderBrush" Value="#FF2F2F2F"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </GridView.ColumnHeaderContainerStyle>
                                <GridViewColumn x:Name="ad1" Header="Active" Width="55" DisplayMemberBinding="{Binding isActive}"/>
                                <GridViewColumn x:Name="ad2" Header="Description" Width="120" DisplayMemberBinding="{Binding Description}"/>
                                <GridViewColumn x:Name="ad3" Header="Address" Width="120" DisplayMemberBinding="{Binding address2}"/>
                                <GridViewColumn x:Name="ad4" Header="Type" Width="120" DisplayMemberBinding="{Binding type2}"/>
                                <GridViewColumn x:Name="ad5" Header="Value" Width="120" DisplayMemberBinding="{Binding value2}"/>
                            </GridView>
                        </ListView.View>
                    </ListView>
                    <dragablz:TabablzControl Grid.Row="2" Grid.Column="1" Background="#3a3a3a" Margin="240 10 0 5"
                                             BorderThickness="0">
                        <TabItem Header="Processes">
                            <Grid>
                                <TreeView x:Name="runningProcs" Background="#FF2F2F2F" Grid.Row="2"
                                TreeViewItem.Selected="runningProcs_Selected" Grid.Column="1"/>
                            </Grid>
                        </TabItem>
                        <TabItem Header="Applications">
                            <Grid>
                                <TreeView x:Name="runningApps" Background="#FF2F2F2F" Grid.Row="2"
                                TreeViewItem.Selected="runningApps_Selected" Grid.Column="1"/>
                            </Grid>
                        </TabItem>
                    </dragablz:TabablzControl>
                </Grid>
            </TabItem>
            <TabItem Header="Decoder/Encoder">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="0.5*"/>
                    </Grid.ColumnDefinitions>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <TextBox AcceptsReturn="True"
                                 Style="{DynamicResource txtBoxStyle}" x:Name="entryText"/>
                        <TextBox Grid.Row="1" AcceptsReturn="True"
                                 Style="{DynamicResource txtBoxStyle}" x:Name="outputText"/>
                    </Grid>
                    <Grid Grid.Column="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="50"/>
                        </Grid.RowDefinitions>
                        <ScrollViewer>
                            <ListView x:Name="decodeEncode"
                                  VerticalAlignment="Top"/>
                        </ScrollViewer>
                        <Button Style="{DynamicResource buttonStyle}" Click="getResultBtn_Click"
                                Grid.Row="1" HorizontalAlignment="Left" Margin="6"
                                Content="Get result"/>
                        <Button Style="{DynamicResource buttonStyle}" Click="clearBtn_Click"
                                Grid.Row="1" HorizontalAlignment="Left" Margin="105,6"
                                Content="Clear List"/>
                    </Grid>
                    <ScrollViewer Grid.Column="2">
                        <ListView VerticalAlignment="Top">
                            <ListViewItem Style="{StaticResource listStyle}"
                                          Content="Base64" PreviewMouseDown="ListViewItem_PreviewMouseDown"/>
                            <ListViewItem Style="{StaticResource listStyle}"
                                          Content="Hexdump" PreviewMouseDown="hexDumpED_PreviewMouseDown"/>
                            <ListViewItem Style="{StaticResource listStyle}"
                                          Content="URL Encoding"/>
                            <ListViewItem Style="{StaticResource listStyle}"
                                          Content="AES"/>
                            <ListViewItem Style="{StaticResource listStyle}"
                                          Content="RC2"/>
                            <ListViewItem Style="{StaticResource listStyle}"
                                          Content="JWT" PreviewMouseDown="jwtED_PreviewMouseDown"/>
                        </ListView>
                    </ScrollViewer>
                </Grid>
            </TabItem>
        </dragablz:TabablzControl>
    </Grid>
</Window>
